---
title: "Checking output data"
author: "JÃ¶rn Alexander Quent"
date: "20 January 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction
I am about to start collecting pilot data to see whether the number of objects etc. works and isn't to easy for instance. It is crucial to throroughly check whether my scripts save the data correctly and it can be used for data analysis before starting piloting. 

# Libaries
```{r}
library(plyr)
```

# Retrieval task
## Is everything saved appropriately?
I realised that I forgot to save which location (target, foil 1 or 2) in earlier check. This is the second attempt after adapting the script accordingly. 

```{r}
# Loading data and adding objects names and specify factors
dataRetrievalTask <- read.table('data/retrievalTask_0.dat', header = FALSE)

names(dataRetrievalTask) <- c('subNo', 'date', 'time', 'trial','objectNumber', 'targetLocation', 'targetRankPre', 'foil1Location', 'foil1RankPre', 'foil2Location', 'foil2RankPre', 'AFCPreTime','rtAFC', 'resAFC', 'accAFC', 'conPreTime', 'rtCon', 'resCon', 'left', 'middle', 'right')

objectNames <- c('microwave','kitchen roll','saucepan', 'toaster','bowl of fruits','tea pot','knife','mixer','bread','glass jug','mug','dishes','towels','toy','pile of books','umbrella','hat','helmet','calendar','fan')

dataRetrievalTask$objectName <- factor(dataRetrievalTask$objectNumber, labels = objectNames)
dataRetrievalTask$left       <- factor(dataRetrievalTask$left, labels = c('target', 'foil1', 'foil2'))
dataRetrievalTask$middle     <- factor(dataRetrievalTask$middle, labels = c('target', 'foil1', 'foil2'))
dataRetrievalTask$right      <- factor(dataRetrievalTask$left, labels = c('target', 'foil1', 'foil2'))

# First AFC response was 1
dataRetrievalTask$resAFC[1]

# First confidence response was 2
dataRetrievalTask$resCon[1]

# Tagert was on the left
dataRetrievalTask$left[1]

# Foil 2 was in middle
dataRetrievalTask$middle[1]

# Foil 1 was on the right
dataRetrievalTask$right[1]

# The AFC response was therefore correct
dataRetrievalTask$accAFC[1]
```

Everything seems to be saved correctly and seems to be useable. 

# Rating task
## Is everything saved appropriately?
```{r}
# Loading data and adding objects names
dataRatingTask        <- read.table('data/ratingTask_0.dat', header = FALSE)
names(dataRatingTask) <- c('subNo', 'date', 'time', 'trial','objectNumber', 'location', 'rating', 'RT')

objectNames <- c('microwave','kitchen roll','saucepan', 'toaster','bowl of fruits','tea pot','knife','mixer','bread','glass jug','mug','dishes','towels','toy','pile of books','umbrella','hat','helmet','calendar','fan')

dataRatingTask$objectName <- factor(dataRatingTask$objectNumber, labels = objectNames)
head(dataRatingTask)
```

Everything seems to be saved correctly and seems to be useable. 

# How to combine both data sets
```{r}
# Collapsing acrossp participants as well as objects and splitting location and rating values into three separate values
dataRatingTask_agg <- ddply(dataRatingTask, c('subNo', 'objectName', 'objectNumber'), summarise, 
                            location1 = location[1],  
                            location2 = location[2],  
                            location3 = location[3],
                            rating1   = rating[1],
                            rating2   = rating[2],
                            rating3   = rating[3])

# Basically I need the following bit to sort the data set
dataRetrievalTask_agg <- ddply(dataRetrievalTask, c('subNo', 'objectName', 'objectNumber'), summarise, 
                               foil1Location  = foil1Location, 
                               targetLocation = targetLocation, 
                               foil2Location  = foil2Location)

# Finding the respective ratings for targets and foils because this information is not saved for the ratingTask data set
# Target
postRatingTarget  <- rep(NA, 20)
postRatingTarget[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$targetLocation)] <- dataRatingTask_agg$rating1[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$targetLocation)]
postRatingTarget[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$targetLocation)] <- dataRatingTask_agg$rating2[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$targetLocation)]
postRatingTarget[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$targetLocation)] <- dataRatingTask_agg$rating3[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$targetLocation)]

# Foil 1
postRatingFoil1  <- rep(NA, 20)
postRatingFoil1[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$foil1Location)] <- dataRatingTask_agg$rating1[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$foil1Location)]
postRatingFoil1[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$foil1Location)] <- dataRatingTask_agg$rating2[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$foil1Location)]
postRatingFoil1[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$foil1Location)] <- dataRatingTask_agg$rating3[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$foil1Location)]

# Foil 2
postRatingFoil2  <- rep(NA, 20)
postRatingFoil2[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$foil2Location)] <- dataRatingTask_agg$rating1[which(dataRatingTask_agg$location1 == dataRetrievalTask_agg$foil2Location)]
postRatingFoil2[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$foil2Location)] <- dataRatingTask_agg$rating2[which(dataRatingTask_agg$location2 == dataRetrievalTask_agg$foil2Location)]
postRatingFoil2[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$foil2Location)] <- dataRatingTask_agg$rating3[which(dataRatingTask_agg$location3 == dataRetrievalTask_agg$foil2Location)]

# Creating new combined data set
combinedData                  <- dataRetrievalTask
combinedData$postRatingTarget <- postRatingTarget
combinedData$postRatingFoil1  <- postRatingFoil1
combinedData$postRatingFoil2  <- postRatingFoil2
head(combinedData)
```

The combined data set seems to be useable as well. This format will be used to create a mock data set. 