<!DOCTYPE html>
<html lang="en" >

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta property="og:title" content="A U-shape that appears as a linear correlation when averaged" />
<meta property="og:description" content="The problem While analysing the data from our U-shape experiments (see pre-registration for context: https://osf.io/kcr2q), we ran into a peculiar problem. As expected, we did find that memory performance can be described as a U-shape function of how expected a certain object is in certain location. However, we also predicted that the memory advantage for highly incongruent item/locations pairings as well as for highly congruent pairings are driven by different processes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jaquent.github.io/2021/02/a-u-shape-that-appears-as-a-linear-correlation-when-averaged/" />
<meta property="article:published_time" content="2021-02-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-02-12T00:00:00+00:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A U-shape that appears as a linear correlation when averaged"/>
<meta name="twitter:description" content="The problem While analysing the data from our U-shape experiments (see pre-registration for context: https://osf.io/kcr2q), we ran into a peculiar problem. As expected, we did find that memory performance can be described as a U-shape function of how expected a certain object is in certain location. However, we also predicted that the memory advantage for highly incongruent item/locations pairings as well as for highly congruent pairings are driven by different processes."/>
<meta name="generator" content="Hugo 0.110.0">


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "A U-shape that appears as a linear correlation when averaged",
  "url": "https://jaquent.github.io/2021/02/a-u-shape-that-appears-as-a-linear-correlation-when-averaged/",
  "wordCount": "1075",
  "datePublished": "2021-02-12T00:00:00+00:00",
  "dateModified": "2021-02-12T00:00:00+00:00",
  "author": {
    "@type": "Person",
    "name": "Jörn Alexander Quent"
  },
  "keywords": "experiments, schemaVR, U-shape"
}
</script>



    <link rel="canonical" href="https://jaquent.github.io/2021/02/a-u-shape-that-appears-as-a-linear-correlation-when-averaged/">

    <title>A U-shape that appears as a linear correlation when averaged | Jörn Alexander Quent&#39;s notebook</title>

    
    <!-- combined, minified CSS -->
    
    <link href="https://jaquent.github.io/css/style.0b72f41a0f22d687d912a8e7c945fc14c7a36daee062380f9fae9958e7d17da6.css" rel="stylesheet" integrity="sha256-C3L0Gg8i1ofZEqjnyUX8FMejba7gYjgPn66ZWOfRfaY=" crossorigin="anonymous">
    

    <!-- minified Font Awesome for SVG icons -->
    
    <script defer src="https://jaquent.github.io/js/fontawesome.min.a290d22177f491b8a83b0ee7eb739224c57ab052d8fab69d8f52aab860e42027.js" integrity="sha256-opDSIXf0kbioOw7n63OSJMV6sFLY&#43;radj1KquGDkICc=" crossorigin="anonymous"></script>

    <!-- RSS 2.0 feed -->
    

    



<link rel="stylesheet" href="https://jaquent.github.io/css/syntax.css">


<style>
 
pre, .chroma {
  background-color: #2d2d2d !important;
  margin: 2px 0 !important;
  padding: 2px 0 !important;  
  border: 1px solid #2d2d2d !important;
  border-radius: 4px !important;
  overflow-x: auto !important;
  max-width: 100% !important;
  line-height: 1 !important;
  position: relative;  
}

 
pre code, .chroma .code {
  display: block !important;
  color: #f8f8f2 !important;
  background-color: transparent !important;
  font-size: 14px !important;
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace !important;
  line-height: 1.4 !important;  
  padding: 0 15px !important;  
  margin: 0 !important;
}

 
.copy-code-btn {
  position: absolute !important;
  top: 4px !important;
  right: 4px !important;
  padding: 3px 8px !important;
  font-size: 11px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  background-color: #555 !important;
  color: white !important;
  border: none !important;
  border-radius: 3px !important;
  cursor: pointer !important;
  opacity: 0.6 !important;
  transition: opacity 0.2s ease !important;
  z-index: 100 !important;
}

.copy-code-btn:hover {
  opacity: 1 !important;
  background-color: #666 !important;
}

 
pre:hover .copy-code-btn,
.chroma:hover .copy-code-btn {
  opacity: 0.8 !important;
}
</style>


<script>
document.addEventListener('DOMContentLoaded', function() {
  
  function findCodeContainer(container) {
    
    
    
    const codeColumn = container.querySelector('.lntd:last-child');
    if (codeColumn) {
      const codePre = codeColumn.querySelector('pre:not(.lnt)');
      if (codePre) return codePre;
      return codeColumn.querySelector('pre, code, .code') || codeColumn;
    }
    
    
    const allPres = container.querySelectorAll('pre');
    for (let pre of allPres) {
      if (!pre.classList.contains('lnt')) {
        return pre;
      }
    }
    
    
    const codeElement = container.querySelector('code');
    if (codeElement) return codeElement;
    
    
    return container;
  }
  
  
  function extractCodeText(container) {
    const codeContainer = findCodeContainer(container);
    
    
    let rawText = codeContainer.textContent || codeContainer.innerText;
    
    
    rawText = rawText.replace(/^\s*\d+\s*/gm, '');
    
    
    rawText = rawText.trim();
    
    return rawText;
  }
  
  
  function addCopyButton(container) {
    
    if (container.querySelector('.copy-code-btn')) {
      return;
    }
    
    
    if (container.closest('.lntd') && container !== document.querySelector('.chroma')) {
      return;
    }
    
    
    const button = document.createElement('button');
    button.className = 'copy-code-btn';
    button.textContent = 'Copy';
    button.title = 'Copy to clipboard';
    
    
    container.style.position = 'relative';
    container.appendChild(button);
    
    
    const codeText = extractCodeText(container);
    
    
    console.log('Code extracted:', codeText.substring(0, 50) + '...');
    
    
    button.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      try {
        await navigator.clipboard.writeText(codeText);
        button.textContent = '✓ Copied!';
        setTimeout(() => button.textContent = 'Copy', 2000);
      } catch (err) {
        console.error('Copy failed:', err);
        button.textContent = '✗ Error';
        setTimeout(() => button.textContent = 'Copy', 2000);
      }
    });
  }
  
  
  
  const chromaContainers = document.querySelectorAll('.chroma:not(.lntd .chroma)');
  
  if (chromaContainers.length > 0) {
    chromaContainers.forEach(addCopyButton);
  } else {
    
    const preElements = document.querySelectorAll('pre:not(.lnt):not(td pre)');
    preElements.forEach(addCopyButton);
  }
});
</script>

<script src="//yihui.org/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ [\'$\',\'$\'], ["\\\\(","\\\\)"] ],
            displayMath: [ [\'$$\',\'$$\'], ["\\\\[","\\\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: \'center\',
        "HTML-CSS": {
            styles: {\'.MathJax_Display\': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
</script>
 
  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="https://jaquent.github.io/">Home</a>
          
          <a class="nav-link" href="/about/" title="">About</a>
          
          
          <a class="nav-link" href="https://jaquent.me/" title="">jaquent.me</a>
          
        </nav>
      </div>
    </div>
    

    
    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title" dir="auto"><a href="https://jaquent.github.io/" rel="home">Jörn Alexander Quent's notebook</a></h1>
        <p class="lead blog-description" dir="auto">where I share semi-interesting stuff from my work</p>
      </div>
    </header>
    
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title" dir="auto"><a href="https://jaquent.github.io/2021/02/a-u-shape-that-appears-as-a-linear-correlation-when-averaged/">A U-shape that appears as a linear correlation when averaged</a></h2>
    <p class="blog-post-meta">
<time datetime="2021-02-12T00:00:00Z">Fri Feb 12, 2021</time>
 in 
<span class="fas fa-folder" aria-hidden="true"></span>&nbsp;<a href="/categories/experiments/" rel="category tag">experiments</a>


<span class="fas fa-tag" aria-hidden="true"></span>&nbsp;<a href="/tags/schemavr/" rel="tag">schemaVR</a>, <a href="/tags/u-shape/" rel="tag">U-shape</a>

</p>
  </header>
  <h1 id="the-problem">The problem</h1>
<p>While analysing the data from our U-shape experiments (see
pre-registration for context: <a href="https://osf.io/kcr2q">https://osf.io/kcr2q</a>), we ran into a
peculiar problem. As expected, we did find that memory performance can
be described as a U-shape function of how expected a certain object is
in certain location. However, we also predicted that the memory
advantage for highly incongruent item/locations pairings as well as for
highly congruent pairings are driven by different processes. More
specifically, we predicted that recollection is driving the incongruency
advantage, while familiarity is contributing to the congruency
advantage. In other words, we predicted linear negative as well as
linear positive relationships respectively.</p>
<p>We actually did find a linear negative relationship when averaging
across subjects yielding one data point per item/location pairing.</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-2-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>In this case, we have a significant negative correlation, r= -.211, p=
.035. We get similar a relationship when we use the normative data that
we collected from 6 participants who viewed all 400 possible pairings
but did not perform a memory task, which is not very surprising as the
correlation between the averaged post-experimental ratings and those
normative ratings are very high, r= .864, p&lt; .001.</p>
<p>However, if we examine the raw (not averaged) data find a U-shape
instead of a linear relationship, which for instance can be seen in this
visualisation of the marginal effects of a corresponding mixed linear
model.</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-3-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>This confused us a lot. To investigate what is going one we have plotted
individual loess smoothing lines because we thought maybe we are
observing something like the Simpson’s paradox. Due to the fact that per
participants there are only 20 data points those lines are very noisy
and difficult to interpret.</p>
<p>On the quest to understand this discrepancy, I have noticed that there
seems to be asymmetric spread. For instance, when we look up the
normative ratings for any pairing that received the lowest expectancy
rating possible (-100) and colour those to show the spread,</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-4-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>we see that there is less (rightward) spread than when we do the same
thing for any pairing that received the highest expectancy rating (100).</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-5-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>While the mean spread from -100 toward the right is 50.59, the spread
from 100 towards the left is 73.97, which are significantly different, p
= .001. This raises the possibility that averaging introduces and
artefact because of this asymmetry, which why we see this discrepancy.</p>
<h1 id="simulation-to-reproduce-this-problem">Simulation to reproduce this problem</h1>
<p>To investigate whether an explanation like this can account for our
discrepancy, we simulated data. This simulation is based on the idea to
have an average expectancy per object. The expectancy for a particular
participants is generated by taking this average expectancy as the mean
of a normal distribution, while using a standard deviation (SD) that
becomes smaller/larger as a function of expectancy.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Set up seed</span>
</span></span><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">1241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Parameters</span>
</span></span><span class="line"><span class="cl"><span class="n">numObj</span>  <span class="o">&lt;-</span> <span class="m">20</span>
</span></span><span class="line"><span class="cl"><span class="n">numSub</span>  <span class="o">&lt;-</span> <span class="m">75</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Similar to our existing data, we have twenty pairings (i.e. objects) per
participants (n = 75). We start with generating 20 random values between
-100 and 100 for our objects.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Give 20 obj true values from uniform distribution between -100 and 100.</span>
</span></span><span class="line"><span class="cl"><span class="n">trueObj_val</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="n">numObj</span><span class="p">,</span> <span class="m">-100</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In order to have an asymmetric spread, we have to scale the standard
deviation (SD) as function of expectancy.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sdScale</span>          <span class="o">&lt;-</span> <span class="m">-1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Have an SD that scales with the true obj values</span>
</span></span><span class="line"><span class="cl"><span class="n">sd_scaled_by_val</span> <span class="o">&lt;-</span> <span class="n">sdScale</span><span class="o">*</span><span class="n">trueObj_val</span> <span class="o">-</span> <span class="n">sdScale</span><span class="o">*</span><span class="m">100</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the next step we generate expectancy ratings for each participant.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># For each subject draw a random value with the mean of the object with SD that scales with this value</span>
</span></span><span class="line"><span class="cl"><span class="n">subjVal</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">numSub</span><span class="p">,</span> <span class="n">numObj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">numSub</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nf">for</span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">numObj</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">subjVal[i</span><span class="p">,</span> <span class="n">j]</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">trueObj_val[j]</span><span class="p">,</span> <span class="n">sd_scaled_by_val[j]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This process will create values that exceed the range of possible vaues,
therefore everything is capped at -100 and 100.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Capping at -100 and 100</span>
</span></span><span class="line"><span class="cl"><span class="n">subjVal[subjVal</span> <span class="o">&gt;</span> <span class="m">100</span><span class="n">]</span>  <span class="o">&lt;-</span> <span class="m">100</span>
</span></span><span class="line"><span class="cl"><span class="n">subjVal[subjVal</span> <span class="o">&lt;</span> <span class="m">-100</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="m">-100</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Everything is bound to one DF</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">sub</span>  <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">numSub</span><span class="p">,</span> <span class="n">numObj</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                 <span class="n">obj</span>  <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">numObj</span><span class="p">,</span> <span class="n">each</span> <span class="o">=</span> <span class="n">numSub</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                 <span class="n">trueObj_val</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">trueObj_val</span><span class="p">,</span> <span class="n">each</span> <span class="o">=</span> <span class="n">numSub</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                 <span class="n">x</span>    <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">subjVal</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>To make it easier to compare the results with our analyse we scale the
data to have mean of 0 and SD of 1.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">df</span><span class="o">$</span><span class="n">s_trueObj_val</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">trueObj_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">$</span><span class="n">s_x</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the last step, we use those expectancy values to create remember
judgements as a quadratic logistic model.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Generating memory performance</span>
</span></span><span class="line"><span class="cl"><span class="n">beta0</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="n">beta1</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="n">beta2</span> <span class="o">&lt;-</span> <span class="m">1.2</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span>     <span class="o">&lt;-</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span><span class="o">*</span><span class="n">df</span><span class="o">$</span><span class="n">s_x</span> <span class="o">+</span> <span class="n">beta2</span><span class="o">*</span><span class="n">df</span><span class="o">$</span><span class="n">s_x</span><span class="o">*</span><span class="n">df</span><span class="o">$</span><span class="n">s_x</span> <span class="c1"># Regression in log odds</span>
</span></span><span class="line"><span class="cl"><span class="n">pr</span>    <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">+</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span> <span class="c1"># Convert to probability.</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">$</span><span class="n">y</span>  <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">numObj</span><span class="o">*</span><span class="n">numSub</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span> <span class="c1"># Get 0 and 1 with binomial link function</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This leads to this result:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">s_x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">geom_jitter</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span>  <span class="m">0.1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_smooth</span><span class="p">(</span><span class="n">colour</span> <span class="o">=</span> <span class="s">&#39;blue&#39;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_smooth</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">s_trueObj_val</span><span class="p">),</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Remembered (simulated)&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Simulated ratings&#34;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Result of simulation&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-14-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>This shows that true quadratic relationship (blue loess line) can appear
as straight line (red loess line) when averaged. Playing around with
parameters of the regression and the SD scale allows one to easily
create examples where the line is slightly negative.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Aggregating to correlate</span>
</span></span><span class="line"><span class="cl"><span class="n">df_agg</span> <span class="o">&lt;-</span> <span class="nf">ddply</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="nf">c</span><span class="p">(</span><span class="s">&#39;obj&#39;</span><span class="p">,</span> <span class="s">&#39;s_trueObj_val &#39;</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                <span class="n">summarise</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">Individual</span>    <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">s_x</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">Individual_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">s_x</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">remNum</span>    <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">remPer</span>    <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get correlation</span>
</span></span><span class="line"><span class="cl"><span class="n">cor3</span> <span class="o">&lt;-</span> <span class="nf">cor.test</span><span class="p">(</span><span class="n">df_agg</span><span class="o">$</span><span class="n">Individual</span><span class="p">,</span> <span class="n">df_agg</span><span class="o">$</span><span class="n">remPer</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this case the correlation is r = -.732, p &lt; .001.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># calculate shift</span>
</span></span><span class="line"><span class="cl"><span class="n">rightShift</span> <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="m">-100</span> <span class="o">-</span> <span class="n">df</span><span class="o">$</span><span class="n">trueObj_val[df</span><span class="o">$</span><span class="n">x</span> <span class="o">==</span> <span class="m">-100</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leftShift</span>  <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="m">100</span> <span class="o">-</span> <span class="n">df</span><span class="o">$</span><span class="n">trueObj_val[df</span><span class="o">$</span><span class="n">x</span> <span class="o">==</span> <span class="m">100</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># T test for the difference</span>
</span></span><span class="line"><span class="cl"><span class="n">test2</span> <span class="o">&lt;-</span> <span class="nf">t.test</span><span class="p">(</span><span class="n">leftShift</span><span class="p">,</span> <span class="n">rightShift</span><span class="p">,</span> <span class="n">var.equal</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If we now calculate the same rightward and leftward shift, we also get a
significant difference, p &lt; .001.</p>
<h1 id="conclusion">Conclusion</h1>
<p>It is possible to explain the discrepancy in our data with this
asymmetry. This can be shown with this simulation. The only caveat that
remains is that the empirical relationship between the the averaged
post-experimental ratings and their SD</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-17-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>is different from the simulated ones as can be seen below.</p>
<p><img src="/post/2021-02-12-a-u-shape-that-appears-as-a-linear-correlation-when-averaged/unnamed-chunk-18-1.png" style="width: auto; height: auto; max-width: 700px"><!-- --></p>
<p>However, we believe this is just a matter of findings the right
parameters and is not as important.</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjaquent.github.io%2f2021%2f02%2fa-u-shape-that-appears-as-a-linear-correlation-when-averaged%2f" title="Share on Facebook"><span class="fab fa-facebook-f fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fjaquent.github.io%2f2021%2f02%2fa-u-shape-that-appears-as-a-linear-correlation-when-averaged%2f" title="Share on LinkedIn"><span class="fab fa-linkedin-in fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fjaquent.github.io%2f2021%2f02%2fa-u-shape-that-appears-as-a-linear-correlation-when-averaged%2f&amp;text=A%20U-shape%20that%20appears%20as%20a%20linear%20correlation%20when%20averaged" title="Tweet this"><span class="fab fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>About</h4>
    <p dir="auto">The idea behind this notebook can be found <a href="/about/">here</a>.</p>
  </section>
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/2026/02/creating-actually-publication-ready-figures-for-journals-using-ggplot2/">Creating actually publication-ready figures for journals using <code>ggplot2</code></a></li>

<li><a href="/2025/06/visualise-your-surface-based-neuroimaging-data-on-flat-maps-using-ciftitools/">Visualise your surface-based neuroimaging data on flat maps using <code>ciftiTools</code></a></li>

<li><a href="/2023/10/running-large-simulations-on-a-desktop-computer-with-r-tips-tricks/">Running large simulations on a desktop computer with R (tips &amp; tricks)</a></li>

<li><a href="/2023/07/a-way-to-get-mni-coordinates-for-subcortical-voxels-of-a-cifti-file/">A way to get MNI coordinates for subcortical voxels of a CIFTI file</a></li>

<li><a href="/2023/02/understanding-the-basics-of-the-general-linear-model-glm-in-the-context-of-fmri/">Understanding the basics of the general linear model (GLM) in the context of fMRI</a></li>

    </ol>
  </section>

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://github.com/JAQuent/">My GitHub page</a></li>
      
    </ol>
  </section>
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <section class="sidebar-module">
    
        
        <h4>Categories</h4>
        <p>
            
            <a class="badge badge-secondary" href="/categories/experiments">experiments</a>
            
            <a class="badge badge-secondary" href="/categories/general">general</a>
            
            <a class="badge badge-secondary" href="/categories/tutorials">tutorials</a>
            
        </p>
        
    
        
        <h4>Tags</h4>
        <p>
            
            <a class="badge badge-secondary" href="/tags/bayesian-stats">bayesian-stats</a>
            
            <a class="badge badge-secondary" href="/tags/brms">brms</a>
            
            <a class="badge badge-secondary" href="/tags/cifti">cifti</a>
            
            <a class="badge badge-secondary" href="/tags/computing">computing</a>
            
            <a class="badge badge-secondary" href="/tags/data-visualisation">data-visualisation</a>
            
            <a class="badge badge-secondary" href="/tags/data-visualization">data-visualization</a>
            
            <a class="badge badge-secondary" href="/tags/figures">figures</a>
            
            <a class="badge badge-secondary" href="/tags/fmri">fmri</a>
            
            <a class="badge badge-secondary" href="/tags/ggplot2">ggplot2</a>
            
            <a class="badge badge-secondary" href="/tags/glm">glm</a>
            
            <a class="badge badge-secondary" href="/tags/hcp">hcp</a>
            
            <a class="badge badge-secondary" href="/tags/ijk">ijk</a>
            
            <a class="badge badge-secondary" href="/tags/json">json</a>
            
            <a class="badge badge-secondary" href="/tags/logistic-regression">logistic-regression</a>
            
            <a class="badge badge-secondary" href="/tags/matlab">matlab</a>
            
            <a class="badge badge-secondary" href="/tags/mixed-linear-models">mixed-linear-models</a>
            
            <a class="badge badge-secondary" href="/tags/mni">mni</a>
            
            <a class="badge badge-secondary" href="/tags/noveltyvr">noveltyvr</a>
            
            <a class="badge badge-secondary" href="/tags/parallelisation">parallelisation</a>
            
            <a class="badge badge-secondary" href="/tags/r">r</a>
            
            <a class="badge badge-secondary" href="/tags/schemavr">schemavr</a>
            
            <a class="badge badge-secondary" href="/tags/scientific-computing">scientific-computing</a>
            
            <a class="badge badge-secondary" href="/tags/sequential-design">sequential-design</a>
            
            <a class="badge badge-secondary" href="/tags/stats">stats</a>
            
            <a class="badge badge-secondary" href="/tags/textures">textures</a>
            
            <a class="badge badge-secondary" href="/tags/tutorial">tutorial</a>
            
            <a class="badge badge-secondary" href="/tags/u-shape">u-shape</a>
            
            <a class="badge badge-secondary" href="/tags/unity">unity</a>
            
            <a class="badge badge-secondary" href="/tags/unity3d">unity3d</a>
            
            <a class="badge badge-secondary" href="/tags/voxel-index-coordinates">voxel-index-coordinates</a>
            
        </p>
        
    
 </section>
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p dir="auto">
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
